# LLM Tags

–£–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ç–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±—Ä–∞—â–µ–Ω–∏–π –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º LLM.

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üè∑Ô∏è **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –æ–±—Ä–∞—â–µ–Ω–∏–π –∫–ª–∏–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ LLM
- üöÄ **–ë–∞—Ç—á–∏–Ω–≥** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ 30-100 –æ–±—Ä–∞—â–µ–Ω–∏–π –∑–∞ —Ä–∞–∑
- ‚ö° **–ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å** - 5 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ LLM
- üíæ **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ** —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –ø—Ä–æ–≥–æ–Ω–∞
- üîÑ **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è** –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–µ–≥–æ–≤
- ü§ñ **Ollama** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã—Ö LLM –º–æ–¥–µ–ª–µ–π (qwen32b –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- üìä **–°–ª–æ–≤–∞—Ä—å —Ç–µ–≥–æ–≤** —Å –æ–ø–∏—Å–∞–Ω–∏—è–º–∏

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.10+
- Ollama (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ LLM)

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Ollama

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Ollama (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞)
# https://ollama.ai/

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ Ollama
ollama serve

# –°–∫–∞—á–∞–π—Ç–µ –º–æ–¥–µ–ª—å
ollama pull qwen2.5:32b
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
import pandas as pd
from llm_tags import TaggingPipeline

# –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
df = pd.read_csv("data.csv")  # –∏–ª–∏ pd.read_parquet("data.parquet")

# –°–æ–∑–¥–∞–Ω–∏–µ pipeline
pipeline = TaggingPipeline()

# –ü—Ä–æ–º–ø—Ç –¥–ª—è —Ç–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
prompt = """
–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –æ–±—Ä–∞—â–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –æ–ø—Ä–µ–¥–µ–ª–∏ —Ç–µ–≥–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ.
–¢–µ–≥–∏ –¥–æ–ª–∂–Ω—ã –æ—Ç—Ä–∞–∂–∞—Ç—å –æ—Å–Ω–æ–≤–Ω—É—é —Ç–µ–º—É –æ–±—Ä–∞—â–µ–Ω–∏—è.
–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞: JSON –º–∞—Å—Å–∏–≤ [{"tag": "–Ω–∞–∑–≤–∞–Ω–∏–µ", "description": "–æ–ø–∏—Å–∞–Ω–∏–µ"}, ...]
"""

# –¢–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
result_df, tags_dict = pipeline.tag(
    df,
    text_column="text",
    tag_prompt=prompt
)

# result_df —Å–æ–¥–µ—Ä–∂–∏—Ç –∏—Å—Ö–æ–¥–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ + –∫–æ–ª–æ–Ω–∫–∞ "tags" (—Å—Ç—Ä–æ–∫–∞ —Å —Ç–µ–≥–∞–º–∏ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)
# tags_dict —Å–æ–¥–µ—Ä–∂–∏—Ç {tag_name: description}

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
result_df.to_csv("tagged_data.csv", index=False)
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –ö–ª–∞—Å—Å `OllamaLLM`

–ö–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å LLM —á–µ—Ä–µ–∑ Ollama.

```python
from llm_tags import OllamaLLM

llm = OllamaLLM(
    api_url="http://localhost:11434/api",  # URL Ollama API
    model="qwen2.5:32b",                    # –ù–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏
    temperature=0.7                         # –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
)
```

#### –ú–µ—Ç–æ–¥ `tag_batch`

```python
results = llm.tag_batch(
    requests=["—Ç–µ–∫—Å—Ç1", "—Ç–µ–∫—Å—Ç2", ...],     # –°–ø–∏—Å–æ–∫ –æ–±—Ä–∞—â–µ–Ω–∏–π
    prompt="–ø—Ä–æ–º–ø—Ç —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏",         # –ü—Ä–æ–º–ø—Ç –¥–ª—è —Ç–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
    existing_tags={"—Ç–µ–≥1": "–æ–ø–∏—Å–∞–Ω–∏–µ1"},    # –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    max_tags=5                              # –ú–∞–∫—Å–∏–º—É–º —Ç–µ–≥–æ–≤ –Ω–∞ –æ–±—Ä–∞—â–µ–Ω–∏–µ
)
```

### –ö–ª–∞—Å—Å `TaggingPipeline`

–û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –¥–ª—è —Ç–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±—Ä–∞—â–µ–Ω–∏–π.

```python
from llm_tags import TaggingPipeline

pipeline = TaggingPipeline(
    llm=None,              # –≠–∫–∑–µ–º–ø–ª—è—Ä OllamaLLM (–µ—Å–ª–∏ None, —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
    batch_size=50,         # –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ (30-100 —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
    num_workers=5,         # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤
    cache_dir="./cache"    # –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è –∫–µ—à–∞
)
```

#### –ú–µ—Ç–æ–¥ `tag`

```python
result_df, tags_dict = pipeline.tag(
    df,                           # DataFrame —Å –æ–±—Ä–∞—â–µ–Ω–∏—è–º–∏
    text_column="text",           # –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–ª–æ–Ω–∫–∏ —Å —Ç–µ–∫—Å—Ç–æ–º
    tag_prompt="–ø—Ä–æ–º–ø—Ç",          # –ü—Ä–æ–º–ø—Ç –¥–ª—è —Ç–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
    existing_tags=None,           # –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    skip_if_tags_count=10,        # –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ —Å >= N —Ç–µ–≥–æ–≤
    max_tags=5                    # –ú–∞–∫—Å–∏–º—É–º —Ç–µ–≥–æ–≤ –Ω–∞ –æ–±—Ä–∞—â–µ–Ω–∏–µ
)
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

- `df` - DataFrame —Å –æ–±—Ä–∞—â–µ–Ω–∏—è–º–∏
- `text_column` - –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–ª–æ–Ω–∫–∏ —Å —Ç–µ–∫—Å—Ç–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–π
- `tag_prompt` - –ø—Ä–æ–º–ø—Ç —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –ø–æ —Ç–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—é
- `existing_tags` - —Å–ª–æ–≤–∞—Ä—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–µ–≥–æ–≤ `{tag_name: description}` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `skip_if_tags_count` - –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Å—Ç—Ä–æ–∫–∏, –≥–¥–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ–≥–æ–≤ >= —ç—Ç–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
  - `10` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) - –ø–æ—á—Ç–∏ –≤—Å–µ –ø–µ—Ä–µ—Ä–∞–∑–º–µ—á–∞–µ–º
  - `0` - –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫–∏ –±–µ–∑ —Ç–µ–≥–æ–≤
- `max_tags` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ–≥–æ–≤ –Ω–∞ –æ–¥–Ω–æ –æ–±—Ä–∞—â–µ–Ω–∏–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 5)

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**

- `result_df` - DataFrame —Å –∏—Å—Ö–æ–¥–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π + –∫–æ–ª–æ–Ω–∫–∞ `tags` (—Å—Ç—Ä–æ–∫–∞ —Å —Ç–µ–≥–∞–º–∏ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)
- `tags_dict` - —Å–ª–æ–≤–∞—Ä—å —Ç–µ–≥–æ–≤ `{tag_name: description}`

## üí° –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ë–∞–∑–æ–≤–æ–µ —Ç–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

```python
import pandas as pd
from llm_tags import TaggingPipeline

# –î–∞–Ω–Ω—ã–µ
df = pd.DataFrame({
    "text": [
        "–ù–µ –º–æ–≥—É –≤–æ–π—Ç–∏ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç",
        "–ó–∞–±—ã–ª –ø–∞—Ä–æ–ª—å",
        "–¢–æ–≤–∞—Ä –Ω–µ –ø—Ä–∏—à–µ–ª",
    ]
})

# Pipeline
pipeline = TaggingPipeline()

# –ü—Ä–æ–º–ø—Ç
prompt = """
–û–ø—Ä–µ–¥–µ–ª–∏ —Ç–µ–≥–∏ –¥–ª—è –æ–±—Ä–∞—â–µ–Ω–∏–π –∫–ª–∏–µ–Ω—Ç–æ–≤ —Ç–µ–ª–µ–∫–æ–º-–æ–ø–µ—Ä–∞—Ç–æ—Ä–∞.
–ö–∞—Ç–µ–≥–æ—Ä–∏–∏: –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, –ø–∞—Ä–æ–ª—å, –¥–æ—Å—Ç–∞–≤–∫–∞, —Ç–∞—Ä–∏—Ñ—ã, —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ_–ø—Ä–æ–±–ª–µ–º—ã.
"""

# –¢–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
result_df, tags_dict = pipeline.tag(df, text_column="text", tag_prompt=prompt)

print(result_df[["text", "tags"]])
```

### –ü—Ä–∏–º–µ—Ä 2: –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –ø—Ä–æ–≥–æ–Ω —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Ç–µ–≥–∞–º–∏

```python
# –ü–µ—Ä–≤—ã–π –ø—Ä–æ–≥–æ–Ω
result_df1, tags_dict1 = pipeline.tag(df1, text_column="text", tag_prompt=prompt)

# –í—Ç–æ—Ä–æ–π –ø—Ä–æ–≥–æ–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ç–µ–≥–æ–≤ –∏–∑ –ø–µ—Ä–≤–æ–≥–æ
result_df2, tags_dict2 = pipeline.tag(
    df2,
    text_column="text",
    tag_prompt=prompt,
    existing_tags=tags_dict1  # –ü–µ—Ä–µ–¥–∞–µ–º —Ç–µ–≥–∏ –∏–∑ –ø–µ—Ä–≤–æ–≥–æ –ø—Ä–æ–≥–æ–Ω–∞
)
```

### –ü—Ä–∏–º–µ—Ä 3: –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –±–µ–∑ —Ç–µ–≥–æ–≤

```python
# DataFrame —Å —É–∂–µ –ø—Ä–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º–∏ —Ç–µ–≥–∞–º–∏
df = pd.DataFrame({
    "text": ["–æ–±—Ä–∞—â–µ–Ω–∏–µ 1", "–æ–±—Ä–∞—â–µ–Ω–∏–µ 2", "–æ–±—Ä–∞—â–µ–Ω–∏–µ 3"],
    "tags": ["—Ç–µ–≥1", "—Ç–µ–≥1, —Ç–µ–≥2", ""]  # –ü–æ—Å–ª–µ–¥–Ω–µ–µ –±–µ–∑ —Ç–µ–≥–æ–≤
})

# –û–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫–∏ –±–µ–∑ —Ç–µ–≥–æ–≤
result_df, tags_dict = pipeline.tag(
    df,
    text_column="text",
    tag_prompt=prompt,
    skip_if_tags_count=0  # –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ, –≥–¥–µ –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã 1 —Ç–µ–≥
)
```

### –ü—Ä–∏–º–µ—Ä 4: –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ —Ñ–∞–π–ª–∞

```python
# –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ CSV
df = pd.read_csv("data.csv")

# –ò–ª–∏ –∏–∑ Parquet
df = pd.read_parquet("data.parquet")

# –ò–ª–∏ –∏–∑ CSV.GZ
df = pd.read_csv("data.csv.gz", compression="gzip")

# –¢–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
result_df, tags_dict = pipeline.tag(df, text_column="text", tag_prompt=prompt)

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
result_df.to_csv("tagged_data.csv", index=False)
```

### –ü—Ä–∏–º–µ—Ä 5: –ö–∞—Å—Ç–æ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```python
from llm_tags import TaggingPipeline, OllamaLLM

# –ö–∞—Å—Ç–æ–º–Ω—ã–π LLM
custom_llm = OllamaLLM(
    api_url="http://localhost:11434/api",
    model="qwen2.5:32b",
    temperature=0.5  # –ú–µ–Ω—å—à–µ –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏
)

# Pipeline —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
pipeline = TaggingPipeline(
    llm=custom_llm,
    batch_size=30,      # –ú–µ–Ω—å—à–∏–π –±–∞—Ç—á
    num_workers=3,      # –ú–µ–Ω—å—à–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
    cache_dir="./my_cache"
)

result_df, tags_dict = pipeline.tag(
    df,
    text_column="text",
    tag_prompt=prompt,
    max_tags=3  # –ú–∞–∫—Å–∏–º—É–º 3 —Ç–µ–≥–∞
)
```

## üîß –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

### `skip_if_tags_count`

–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫–∏–µ —Å—Ç—Ä–æ–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å:

- `skip_if_tags_count=10` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) - –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ —Å 10+ —Ç–µ–≥–∞–º–∏ (–ø–æ—á—Ç–∏ –≤—Å–µ –ø–µ—Ä–µ—Ä–∞–∑–º–µ—á–∞–µ–º)
- `skip_if_tags_count=0` - –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫–∏ –±–µ–∑ —Ç–µ–≥–æ–≤
- `skip_if_tags_count=1` - –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —Å—Ç—Ä–æ–∫–∏ —Å 0 —Ç–µ–≥–∞–º–∏ (–ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Å 1+)
- `skip_if_tags_count=2` - –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —Å—Ç—Ä–æ–∫–∏ —Å 0-1 —Ç–µ–≥–∞–º–∏ (–ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Å 2+)

### `max_tags`

–û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ–≥–æ–≤ –Ω–∞ –æ–¥–Ω–æ –æ–±—Ä–∞—â–µ–Ω–∏–µ:

- `max_tags=5` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) - –º–∞–∫—Å–∏–º—É–º 5 —Ç–µ–≥–æ–≤
- `max_tags=3` - –º–∞–∫—Å–∏–º—É–º 3 —Ç–µ–≥–∞
- `max_tags=1` - —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ç–µ–≥ –Ω–∞ –æ–±—Ä–∞—â–µ–Ω–∏–µ

## üíæ –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ

Pipeline –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –∫–µ—à (`./cache/tags_cache.csv` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é).

–ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∑–∞–ø—É—Å–∫–µ:
- –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–∑ –∫–µ—à–∞
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ –∏–ª–∏ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏
- –ö–µ—à –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –Ω–æ–≤—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏

**–§–æ—Ä–º–∞—Ç –∫–µ—à–∞:**
```csv
request_id,tags
req-000001,"—Ç–µ–≥1, —Ç–µ–≥2"
req-000002,"—Ç–µ–≥3"
```

## üìä –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö

### –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

DataFrame –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å:
- –ö–æ–ª–æ–Ω–∫—É —Å —Ç–µ–∫—Å—Ç–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `text`)
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –∫–æ–ª–æ–Ω–∫—É `request_id` (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç)
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –∫–æ–ª–æ–Ω–∫—É `tags` (–¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –ø—Ä–æ–≥–æ–Ω–∞)

### –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

**DataFrame:**
- –í—Å–µ –∏—Å—Ö–æ–¥–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏
- –ö–æ–ª–æ–Ω–∫–∞ `tags` - —Å—Ç—Ä–æ–∫–∞ —Å —Ç–µ–≥–∞–º–∏ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é (–Ω–∞–ø—Ä–∏–º–µ—Ä: "—Ç–µ–≥1, —Ç–µ–≥2, —Ç–µ–≥3")

**–°–ª–æ–≤–∞—Ä—å —Ç–µ–≥–æ–≤:**
```python
{
    "–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è": "–ü—Ä–æ–±–ª–µ–º—ã —Å–æ –≤—Ö–æ–¥–æ–º –≤ —Å–∏—Å—Ç–µ–º—É",
    "–ø–∞—Ä–æ–ª—å": "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–ª–∏ —Å–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è",
    "–¥–æ—Å—Ç–∞–≤–∫–∞": "–í–æ–ø—Ä–æ—Å—ã –ø–æ –¥–æ—Å—Ç–∞–≤–∫–µ —Ç–æ–≤–∞—Ä–æ–≤"
}
```

## üé® –ü—Ä–æ–º–ø—Ç—ã

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–º–ø—Ç–∞

–ü—Ä–æ–º–ø—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å:
1. –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏
2. –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–µ–≥–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
3. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Ñ–æ—Ä–º–∞—Ç—É –æ—Ç–≤–µ—Ç–∞

### –ü—Ä–∏–º–µ—Ä –ø—Ä–æ–º–ø—Ç–∞

```python
prompt = """
–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –æ–±—Ä–∞—â–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ —Ç–µ–ª–µ–∫–æ–º-–æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –∏ –æ–ø—Ä–µ–¥–µ–ª–∏ —Ç–µ–≥–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ.

–í–æ–∑–º–æ–∂–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–µ–≥–æ–≤:
- –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è: –ø—Ä–æ–±–ª–µ–º—ã —Å–æ –≤—Ö–æ–¥–æ–º –≤ —Å–∏—Å—Ç–µ–º—É
- –ø–∞—Ä–æ–ª—å: –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–ª–∏ —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è
- —Ç–∞—Ä–∏—Ñ—ã: –≤–æ–ø—Ä–æ—Å—ã –ø–æ —Ç–∞—Ä–∏—Ñ–Ω—ã–º –ø–ª–∞–Ω–∞–º
- —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ_–ø—Ä–æ–±–ª–µ–º—ã: –Ω–µ–ø–æ–ª–∞–¥–∫–∏ —Å —É—Å–ª—É–≥–∞–º–∏
- –±–∏–ª–ª–∏–Ω–≥: –≤–æ–ø—Ä–æ—Å—ã –ø–æ –æ–ø–ª–∞—Ç–µ –∏ —Å–ø–∏—Å–∞–Ω–∏—è–º

–ú–æ–∂–µ—à—å —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Ç–µ–≥–∏ –µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –Ω–µ –ø–æ–¥—Ö–æ–¥—è—Ç.

–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞: JSON –º–∞—Å—Å–∏–≤ —Å –æ–±—ä–µ–∫—Ç–∞–º–∏ {"tag": "–Ω–∞–∑–≤–∞–Ω–∏–µ", "description": "–æ–ø–∏—Å–∞–Ω–∏–µ"}
–ú–∞–∫—Å–∏–º—É–º 5 —Ç–µ–≥–æ–≤ –Ω–∞ –æ–±—Ä–∞—â–µ–Ω–∏–µ.
"""
```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞

- **30-50** - –¥–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ –∏–ª–∏ —Å–ª–∞–±—ã—Ö GPU
- **50-70** - –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å
- **70-100** - –¥–ª—è –º–æ—â–Ω—ã—Ö GPU –∏ –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤

### –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤

- **3** - –¥–ª—è GPU —Å 8GB VRAM
- **5** - –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- **7-10** - –¥–ª—è –º–æ—â–Ω—ã—Ö GPU —Å 16GB+ VRAM

### –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞

- **0.3-0.5** - –±–æ–ª–µ–µ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- **0.7** - –±–∞–ª–∞–Ω—Å (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- **0.9-1.0** - –±–æ–ª–µ–µ –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–µ —Ç–µ–≥–∏

## üêõ Troubleshooting

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Ollama

```
ConnectionError: –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Ollama
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ Ollama –∑–∞–ø—É—â–µ–Ω–∞: `ollama serve`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –º–æ–¥–µ–ª—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞: `ollama list`
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –º–æ–¥–µ–ª—å –µ—Å–ª–∏ –Ω—É–∂–Ω–æ: `ollama pull qwen2.5:32b`

### –ú–µ–¥–ª–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–º–µ–Ω—å—à–∏—Ç–µ `batch_size` (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–æ 30)
2. –£–º–µ–Ω—å—à–∏—Ç–µ `num_workers` (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–æ 3)
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä—É—é –º–æ–¥–µ–ª—å

### –û—à–∏–±–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–º–µ–Ω—å—à–∏—Ç–µ `temperature` (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–æ 0.5)
2. –£–ª—É—á—à–∏—Ç–µ –ø—Ä–æ–º–ø—Ç - –¥–æ–±–∞–≤—å—Ç–µ –±–æ–ª—å—à–µ –ø—Ä–∏–º–µ—Ä–æ–≤ —Ñ–æ—Ä–º–∞—Ç–∞
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ–ª–µ–µ –º–æ—â–Ω—É—é –º–æ–¥–µ–ª—å

## üìù –ü—Ä–∏–º–µ—Ä—ã

–ü–æ–ª–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–º. –≤ —Ñ–∞–π–ª–µ [`example.py`](example.py).

–ó–∞–ø—É—Å–∫ –ø—Ä–∏–º–µ—Ä–æ–≤:

```bash
python example.py
```

## ü§ù –í–∫–ª–∞–¥

–ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –Ω–∞ –±–∞–∑–µ [llm_clustering](../llm_clustering).

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

